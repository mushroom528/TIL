# 쿠키와 세션

## 쿠키
- 사용자의 브라우저에 저장된다.
	- 정확히는 사용자의 컴퓨터에 저장되며(SSD, HDD와 같은 비휘발성 저장장치) 브라우저가 이를 관리한다.
	- 일종의 작은 텍스트 파일 형태로 관리함
- 사용자 관련 정보를 관리한다.
	- ex) 자동 로그인 유무, 장바구니, 사용자의 패턴(패턴을 파악하여 사용자 맞춤 광고를 표시하기 위해..)
- 이름, 값, 만료일, 경로 정보, 보안 플래그, HTTP 전용 플래그, SameSite 요청으로 구성되어 있음
- 서버와 클라이언트가 서로 요청과 응답을 주고 받을 때 마다 메세지에 쿠키를 포함시키는 방식으로 사용
## 세션
- 사용자와 웹 어플리케이션 간의 상태를 유지하기 위해 사용한다.
- 세션 데이터는 서버에 저장된다.
	- 브라우저에서 관리하는 세션ID를 통해 서버에 존재하는 세션데이터에 접근
- 세션ID: 세션을 식별하기 위해 고유한 ID, 주로 쿠키에 저장되며 요청을 보낼 때 해당 ID도 함께 보낸다.
- 일정 시간 유지되며, 사용자가 일정 시간동안 활동하지 않으면 만료된다.
### 문제점
세션은 클러스터링 환경에서 아래와 같은 문제가 발생할 수 있다.
- 서버가 여러 대로 구성되기 때문에, 한 사용자의 요청이 매번 다른 서버로 전달될 수 있어 세션 데이터의 일관성이 맞지 않을 수 있다.
	- ex) A 서버에서 로그인 후 다음 요청은 B 서버에서 수행 -> B 서버에는 사용자 정보가 없기 때문에 재로그인 요청이 발생할 수 있음.
### 해결 방법
- Sticky Session
	- 사용자가 한 번 접속한 서버에 계속 연결되도록 하는 방식
	- 구현이 쉽다.
	- 특정 서버에 부하가 집중 될 수 있다. (LB의 이점을 살리지 못함)
- 세션 중앙화
	- 세션 데이터를 서버 로컬이 아닌 데이터베이스에 저장한다.
	- 주로 메모리 DB(Redis, Memcached)와 같은 빠른 DB를 사용
- JWT 사용
	- 클라이언트가 토큰을 가지면서 인증을 처리한다.
	- 세션 이슈를 신경 쓸 필요 없이 클러스터링 환경에서 유리하다.
